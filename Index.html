<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

<h3>Sender (Mobile)</h3>
<p id="loc">Location loading...</p>
<video id="v" autoplay muted playsinline width="250"></video>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
// Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
import { getAnalytics } from "firebase/analytics";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries
// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
apiKey: "AIzaSyAvRQtIjzccaPv5UesuQTGNuPxJRjZLujM",
authDomain: "real-time-database-1051b.firebaseapp.com",
projectId: "real-time-database-1051b",
storageBucket: "real-time-database-1051b.firebasestorage.app",
messagingSenderId: "11751688796",
appId: "1:11751688796:web:5d6e50473c6c22433ff499",
measurementId: "G-Q2C3XPBMB6"
};
// Initialize Firebaseconst app = initializeApp(firebaseConfig);const analytics = getAnalytics(app);ðŸ”´ STEP 1: YAHAN APNA FIREBASE CONFIG PASTE KARO */
//const firebaseConfig = {
 // apiKey: "PASTE_HERE",
//  authDomain: "PASTE_HERE",
//  databaseURL: "PASTE_HERE",
//  projectId: "PASTE_HERE",
//  storageBucket: "PASTE_HERE",
//  messagingSenderId: "PASTE_HERE",
//  appId: "PASTE_HERE"
//};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const pc = new RTCPeerConnection();

/* ðŸŽ¥ CAMERA */
navigator.mediaDevices.getUserMedia({ video: true }).then(stream => {
  v.srcObject = stream;
  stream.getTracks().forEach(t => pc.addTrack(t, stream));
});

/* ðŸ“ LOCATION */
navigator.geolocation.getCurrentPosition(p => {
  loc.innerText = `Lat: ${p.coords.latitude}, Long: ${p.coords.longitude}`;
  db.ref("location").set({
    lat: p.coords.latitude,
    lon: p.coords.longitude
  });
});

/* ðŸ” SIGNALING */
pc.onicecandidate = e => {
  if (e.candidate) db.ref("offerCandidates").push(e.candidate.toJSON());
};

(async () => {
  const offer = await pc.createOffer();
  await pc.setLocalDescription(offer);
  db.ref("offer").set(offer);
})();

db.ref("answer").on("value", snap => {
  if (snap.val()) pc.setRemoteDescription(snap.val());
});
</script>

</body>
</html>